<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<!--
generated by Pygments <https://pygments.org/>
Copyright 2006-2022 by the Pygments team.
Licensed under the BSD license, see LICENSE for details.
-->
<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=None">
  <style type="text/css">
/*
generated by Pygments <https://pygments.org/>
Copyright 2006-2022 by the Pygments team.
Licensed under the BSD license, see LICENSE for details.
*/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
body .hll { background-color: #ffffcc }
body { background: #f8f8f8; }
body .c { color: #3D7B7B; font-style: italic } /* Comment */
body .err { border: 1px solid #FF0000 } /* Error */
body .k { color: #008000; font-weight: bold } /* Keyword */
body .o { color: #666666 } /* Operator */
body .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
body .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
body .cp { color: #9C6500 } /* Comment.Preproc */
body .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
body .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
body .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #E40000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #008400 } /* Generic.Inserted */
body .go { color: #717171 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
body .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #008000 } /* Keyword.Pseudo */
body .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #B00040 } /* Keyword.Type */
body .m { color: #666666 } /* Literal.Number */
body .s { color: #BA2121 } /* Literal.String */
body .na { color: #687822 } /* Name.Attribute */
body .nb { color: #008000 } /* Name.Builtin */
body .nc { color: #0000FF; font-weight: bold } /* Name.Class */
body .no { color: #880000 } /* Name.Constant */
body .nd { color: #AA22FF } /* Name.Decorator */
body .ni { color: #717171; font-weight: bold } /* Name.Entity */
body .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
body .nf { color: #0000FF } /* Name.Function */
body .nl { color: #767600 } /* Name.Label */
body .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #19177C } /* Name.Variable */
body .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mb { color: #666666 } /* Literal.Number.Bin */
body .mf { color: #666666 } /* Literal.Number.Float */
body .mh { color: #666666 } /* Literal.Number.Hex */
body .mi { color: #666666 } /* Literal.Number.Integer */
body .mo { color: #666666 } /* Literal.Number.Oct */
body .sa { color: #BA2121 } /* Literal.String.Affix */
body .sb { color: #BA2121 } /* Literal.String.Backtick */
body .sc { color: #BA2121 } /* Literal.String.Char */
body .dl { color: #BA2121 } /* Literal.String.Delimiter */
body .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BA2121 } /* Literal.String.Double */
body .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BA2121 } /* Literal.String.Heredoc */
body .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #A45A77 } /* Literal.String.Regex */
body .s1 { color: #BA2121 } /* Literal.String.Single */
body .ss { color: #19177C } /* Literal.String.Symbol */
body .bp { color: #008000 } /* Name.Builtin.Pseudo */
body .fm { color: #0000FF } /* Name.Function.Magic */
body .vc { color: #19177C } /* Name.Variable.Class */
body .vg { color: #19177C } /* Name.Variable.Global */
body .vi { color: #19177C } /* Name.Variable.Instance */
body .vm { color: #19177C } /* Name.Variable.Magic */
body .il { color: #666666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nn">org.ektorp.util</span><span class="p">;</span><span class="w"></span>
<span class="cm">/**</span>
<span class="cm"> * &lt;p&gt;Encodes and decodes to and from Base64 notation.&lt;/p&gt;</span>
<span class="cm"> * &lt;p&gt;Homepage: &lt;a href=&quot;http://iharder.net/base64&quot;&gt;http://iharder.net/base64&lt;/a&gt;.&lt;/p&gt;</span>
<span class="cm"> * </span>
<span class="cm"> * &lt;p&gt;Example:&lt;/p&gt;</span>
<span class="cm"> * </span>
<span class="cm"> * &lt;code&gt;String encoded = Base64.encode( myByteArray );&lt;/code&gt;</span>
<span class="cm"> * &lt;br /&gt;</span>
<span class="cm"> * &lt;code&gt;byte[] myByteArray = Base64.decode( encoded );&lt;/code&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;p&gt;The &lt;tt&gt;options&lt;/tt&gt; parameter, which appears in a few places, is used to pass </span>
<span class="cm"> * several pieces of information to the encoder. In the &quot;higher level&quot; methods such as </span>
<span class="cm"> * encodeBytes( bytes, options ) the options parameter can be used to indicate such </span>
<span class="cm"> * things as first gzipping the bytes before encoding them, not inserting linefeeds,</span>
<span class="cm"> * and encoding using the URL-safe and Ordered dialects.&lt;/p&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;p&gt;Note, according to &lt;a href=&quot;http://www.faqs.org/rfcs/rfc3548.html&quot;&gt;RFC3548&lt;/a&gt;,</span>
<span class="cm"> * Section 2.1, implementations should not add line feeds unless explicitly told</span>
<span class="cm"> * to do so. I&#39;ve got Base64 set to this behavior now, although earlier versions</span>
<span class="cm"> * broke lines by default.&lt;/p&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;p&gt;The constants defined in Base64 can be OR-ed together to combine options, so you </span>
<span class="cm"> * might make a call like this:&lt;/p&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;code&gt;String encoded = Base64.encodeBytes( mybytes, Base64.GZIP | Base64.DO_BREAK_LINES );&lt;/code&gt;</span>
<span class="cm"> * &lt;p&gt;to compress the data before encoding it and then making the output have newline characters.&lt;/p&gt;</span>
<span class="cm"> * &lt;p&gt;Also...&lt;/p&gt;</span>
<span class="cm"> * &lt;code&gt;String encoded = Base64.encodeBytes( crazyString.getBytes() );&lt;/code&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;p&gt;</span>
<span class="cm"> * Change Log:</span>
<span class="cm"> * &lt;/p&gt;</span>
<span class="cm"> * &lt;ul&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.3.7 - Fixed subtle bug when base 64 input stream contained the</span>
<span class="cm"> *   value 01111111, which is an invalid base 64 character but should not</span>
<span class="cm"> *   throw an ArrayIndexOutOfBoundsException either. Led to discovery of</span>
<span class="cm"> *   mishandling (or potential for better handling) of other bad input</span>
<span class="cm"> *   characters. You should now get an IOException if you try decoding</span>
<span class="cm"> *   something that has bad characters in it.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.3.6 - Fixed bug when breaking lines and the final byte of the encoded</span>
<span class="cm"> *   string ended in the last column; the buffer was not properly shrunk and</span>
<span class="cm"> *   contained an extra (null) byte that made it into the string.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.3.5 - Fixed bug in {@link #encodeFromFile} where estimated buffer size</span>
<span class="cm"> *   was wrong for files of size 31, 34, and 37 bytes.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.3.4 - Fixed bug when working with gzipped streams whereby flushing</span>
<span class="cm"> *   the Base64.OutputStream closed the Base64 encoding (by padding with equals</span>
<span class="cm"> *   signs) too soon. Also added an option to suppress the automatic decoding</span>
<span class="cm"> *   of gzipped streams. Also added experimental support for specifying a</span>
<span class="cm"> *   class loader when using the</span>
<span class="cm"> *   {@link #decodeToObject(java.lang.String, int, java.lang.ClassLoader)}</span>
<span class="cm"> *   method.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.3.3 - Changed default char encoding to US-ASCII which reduces the internal Java</span>
<span class="cm"> *   footprint with its CharEncoders and so forth. Fixed some javadocs that were</span>
<span class="cm"> *   inconsistent. Removed imports and specified things like java.io.IOException</span>
<span class="cm"> *   explicitly inline.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.3.2 - Reduced memory footprint! Finally refined the &quot;guessing&quot; of how big the</span>
<span class="cm"> *   final encoded data will be so that the code doesn&#39;t have to create two output</span>
<span class="cm"> *   arrays: an oversized initial one and then a final, exact-sized one. Big win</span>
<span class="cm"> *   when using the {@link #encodeBytesToBytes(byte[])} family of methods (and not</span>
<span class="cm"> *   using the gzip options which uses a different mechanism with streams and stuff).&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.3.1 - Added {@link #encodeBytesToBytes(byte[], int, int, int)} and some</span>
<span class="cm"> *   similar helper methods to be more efficient with memory by not returning a</span>
<span class="cm"> *   String but just a byte array.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.3 - &lt;strong&gt;This is not a drop-in replacement!&lt;/strong&gt; This is two years of comments</span>
<span class="cm"> *   and bug fixes queued up and finally executed. Thanks to everyone who sent</span>
<span class="cm"> *   me stuff, and I&#39;m sorry I wasn&#39;t able to distribute your fixes to everyone else.</span>
<span class="cm"> *   Much bad coding was cleaned up including throwing exceptions where necessary </span>
<span class="cm"> *   instead of returning null values or something similar. Here are some changes</span>
<span class="cm"> *   that may affect you:</span>
<span class="cm"> *   &lt;ul&gt;</span>
<span class="cm"> *    &lt;li&gt;&lt;em&gt;Does not break lines, by default.&lt;/em&gt; This is to keep in compliance with</span>
<span class="cm"> *      &lt;a href=&quot;http://www.faqs.org/rfcs/rfc3548.html&quot;&gt;RFC3548&lt;/a&gt;.&lt;/li&gt;</span>
<span class="cm"> *    &lt;li&gt;&lt;em&gt;Throws exceptions instead of returning null values.&lt;/em&gt; Because some operations</span>
<span class="cm"> *      (especially those that may permit the GZIP option) use IO streams, there</span>
<span class="cm"> *      is a possiblity of an java.io.IOException being thrown. After some discussion and</span>
<span class="cm"> *      thought, I&#39;ve changed the behavior of the methods to throw java.io.IOExceptions</span>
<span class="cm"> *      rather than return null if ever there&#39;s an error. I think this is more</span>
<span class="cm"> *      appropriate, though it will require some changes to your code. Sorry,</span>
<span class="cm"> *      it should have been done this way to begin with.&lt;/li&gt;</span>
<span class="cm"> *    &lt;li&gt;&lt;em&gt;Removed all references to System.out, System.err, and the like.&lt;/em&gt;</span>
<span class="cm"> *      Shame on me. All I can say is sorry they were ever there.&lt;/li&gt;</span>
<span class="cm"> *    &lt;li&gt;&lt;em&gt;Throws NullPointerExceptions and IllegalArgumentExceptions&lt;/em&gt; as needed</span>
<span class="cm"> *      such as when passed arrays are null or offsets are invalid.&lt;/li&gt;</span>
<span class="cm"> *    &lt;li&gt;Cleaned up as much javadoc as I could to avoid any javadoc warnings.</span>
<span class="cm"> *      This was especially annoying before for people who were thorough in their</span>
<span class="cm"> *      own projects and then had gobs of javadoc warnings on this file.&lt;/li&gt;</span>
<span class="cm"> *   &lt;/ul&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.2.1 - Fixed bug using URL_SAFE and ORDERED encodings. Fixed bug</span>
<span class="cm"> *   when using very small files (~&amp;lt; 40 bytes).&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.2 - Added some helper methods for encoding/decoding directly from</span>
<span class="cm"> *   one file to the next. Also added a main() method to support command line</span>
<span class="cm"> *   encoding/decoding from one file to the next. Also added these Base64 dialects:</span>
<span class="cm"> *   &lt;ol&gt;</span>
<span class="cm"> *   &lt;li&gt;The default is RFC3548 format.&lt;/li&gt;</span>
<span class="cm"> *   &lt;li&gt;Calling Base64.setFormat(Base64.BASE64_FORMAT.URLSAFE_FORMAT) generates</span>
<span class="cm"> *   URL and file name friendly format as described in Section 4 of RFC3548.</span>
<span class="cm"> *   http://www.faqs.org/rfcs/rfc3548.html&lt;/li&gt;</span>
<span class="cm"> *   &lt;li&gt;Calling Base64.setFormat(Base64.BASE64_FORMAT.ORDERED_FORMAT) generates</span>
<span class="cm"> *   URL and file name friendly format that preserves lexical ordering as described</span>
<span class="cm"> *   in http://www.faqs.org/qa/rfcc-1940.html&lt;/li&gt;</span>
<span class="cm"> *   &lt;/ol&gt;</span>
<span class="cm"> *   Special thanks to Jim Kellerman at &lt;a href=&quot;http://www.powerset.com/&quot;&gt;http://www.powerset.com/&lt;/a&gt;</span>
<span class="cm"> *   for contributing the new Base64 dialects.</span>
<span class="cm"> *  &lt;/li&gt;</span>
<span class="cm"> * </span>
<span class="cm"> *  &lt;li&gt;v2.1 - Cleaned up javadoc comments and unused variables and methods. Added</span>
<span class="cm"> *   some convenience methods for reading and writing to and from files.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.0.2 - Now specifies UTF-8 encoding in places where the code fails on systems</span>
<span class="cm"> *   with other encodings (like EBCDIC).&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.0.1 - Fixed an error when decoding a single byte, that is, when the</span>
<span class="cm"> *   encoded data was a single byte.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v2.0 - I got rid of methods that used booleans to set options. </span>
<span class="cm"> *   Now everything is more consolidated and cleaner. The code now detects</span>
<span class="cm"> *   when data that&#39;s being decoded is gzip-compressed and will decompress it</span>
<span class="cm"> *   automatically. Generally things are cleaner. You&#39;ll probably have to</span>
<span class="cm"> *   change some method calls that you were making to support the new</span>
<span class="cm"> *   options format (&lt;tt&gt;int&lt;/tt&gt;s that you &quot;OR&quot; together).&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v1.5.1 - Fixed bug when decompressing and decoding to a             </span>
<span class="cm"> *   byte[] using &lt;tt&gt;decode( String s, boolean gzipCompressed )&lt;/tt&gt;.      </span>
<span class="cm"> *   Added the ability to &quot;suspend&quot; encoding in the Output Stream so        </span>
<span class="cm"> *   you can turn on and off the encoding if you need to embed base64       </span>
<span class="cm"> *   data in an otherwise &quot;normal&quot; stream (like an XML file).&lt;/li&gt;  </span>
<span class="cm"> *  &lt;li&gt;v1.5 - Output stream pases on flush() command but doesn&#39;t do anything itself.</span>
<span class="cm"> *      This helps when using GZIP streams.</span>
<span class="cm"> *      Added the ability to GZip-compress objects before encoding them.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v1.4 - Added helper methods to read/write files.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v1.3.6 - Fixed OutputStream.flush() so that &#39;position&#39; is reset.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v1.3.5 - Added flag to turn on and off line breaks. Fixed bug in input stream</span>
<span class="cm"> *      where last buffer being read, if not completely full, was not returned.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v1.3.4 - Fixed when &quot;improperly padded stream&quot; error was thrown at the wrong time.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;v1.3.3 - Fixed I/O streams which were totally messed up.&lt;/li&gt;</span>
<span class="cm"> * &lt;/ul&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;p&gt;</span>
<span class="cm"> * I am placing this code in the Public Domain. Do with it as you will.</span>
<span class="cm"> * This software comes with no guarantees or warranties but with</span>
<span class="cm"> * plenty of well-wishing instead!</span>
<span class="cm"> * Please visit &lt;a href=&quot;http://iharder.net/base64&quot;&gt;http://iharder.net/base64&lt;/a&gt;</span>
<span class="cm"> * periodically to check for updates or to contribute improvements.</span>
<span class="cm"> * &lt;/p&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * @author Robert Harder</span>
<span class="cm"> * @author rob@iharder.net</span>
<span class="cm"> * @version 2.3.7</span>
<span class="cm"> */</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Base64</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span>
<span class="cm">/* ********  P U B L I C   F I E L D S  ******** */</span><span class="w">   </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** No options specified. Value is zero. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">NO_OPTIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** Specify encoding in first bit. Value is one. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ENCODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** Specify decoding in first bit. Value is zero. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">DECODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>

<span class="w">    </span><span class="cm">/** Specify that data should be gzip-compressed in second bit. Value is two. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">GZIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="cm">/** Specify that gzipped data should &lt;em&gt;not&lt;/em&gt; be automatically gunzipped. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">DONT_GUNZIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** Do break lines when encoding. Value is 8. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">DO_BREAK_LINES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span>
<span class="w">    </span><span class="cm">/** </span>
<span class="cm">     * Encode using Base64-like encoding that is URL- and Filename-safe as described</span>
<span class="cm">     * in Section 4 of RFC3548: </span>
<span class="cm">     * &lt;a href=&quot;http://www.faqs.org/rfcs/rfc3548.html&quot;&gt;http://www.faqs.org/rfcs/rfc3548.html&lt;/a&gt;.</span>
<span class="cm">     * It is important to note that data encoded this way is &lt;em&gt;not&lt;/em&gt; officially valid Base64, </span>
<span class="cm">     * or at the very least should not be called Base64 without also specifying that is</span>
<span class="cm">     * was encoded using the URL- and Filename-safe dialect.</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">URL_SAFE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span><span class="w"></span>


<span class="w">     </span><span class="cm">/**</span>
<span class="cm">      * Encode using the special &quot;ordered&quot; dialect of Base64 described here:</span>
<span class="cm">      * &lt;a href=&quot;http://www.faqs.org/qa/rfcc-1940.html&quot;&gt;http://www.faqs.org/qa/rfcc-1940.html&lt;/a&gt;.</span>
<span class="cm">      */</span><span class="w"></span>
<span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ORDERED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="cm">/* ********  P R I V A T E   F I E L D S  ******** */</span><span class="w">  </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** Maximum line length (76) of Base64 output. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">MAX_LINE_LENGTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">76</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** The equals sign (=) as a byte. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="w"> </span><span class="n">EQUALS_SIGN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;=&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** The new line character (\n) as a byte. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="w"> </span><span class="n">NEW_LINE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** Preferred encoding. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">PREFERRED_ENCODING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;US-ASCII&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">	</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="w"> </span><span class="n">WHITE_SPACE_ENC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="c1">// Indicates white space in encoding</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="w"> </span><span class="n">EQUALS_SIGN_ENC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// Indicates equals sign in encoding</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span>
<span class="cm">/* ********  S T A N D A R D   B A S E 6 4   A L P H A B E T  ******** */</span><span class="w">	</span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** The 64 valid Base64 values. */</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* Host platform me be something funny like EBCDIC, so we hardcode these values. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">_STANDARD_ALPHABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;G&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;H&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;I&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;J&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;K&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;N&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;P&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Q&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;R&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;T&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;V&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;X&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Z&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;d&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;g&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;h&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;i&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;j&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;m&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;n&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;o&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;p&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;q&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;s&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;u&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;v&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;x&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;y&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;z&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;6&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;7&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;8&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;9&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;+&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;/&#39;</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/** </span>
<span class="cm">     * Translates a Base64 value to either its 6-bit reconstruction value</span>
<span class="cm">     * or a negative number indicating some other meaning.</span>
<span class="cm">     **/</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">_STANDARD_DECODABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                 </span><span class="c1">// Decimal  0 -  8</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                      </span><span class="c1">// Whitespace: Tab and Linefeed</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                      </span><span class="c1">// Decimal 11 - 12</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Whitespace: Carriage Return</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 14 - 26</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                             </span><span class="c1">// Decimal 27 - 31</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Whitespace: Space</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">              </span><span class="c1">// Decimal 33 - 42</span><span class="w"></span>
<span class="w">        </span><span class="mi">62</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Plus sign at decimal 43</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// Decimal 44 - 46</span><span class="w"></span>
<span class="w">        </span><span class="mi">63</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Slash at decimal 47</span><span class="w"></span>
<span class="w">        </span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="w">              </span><span class="c1">// Numbers zero through nine</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// Decimal 58 - 60</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Equals sign at decimal 61</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                      </span><span class="c1">// Decimal 62 - 64</span><span class="w"></span>
<span class="w">        </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="w">            </span><span class="c1">// Letters &#39;A&#39; through &#39;N&#39;</span><span class="w"></span>
<span class="w">        </span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="w">        </span><span class="c1">// Letters &#39;O&#39; through &#39;Z&#39;</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                          </span><span class="c1">// Decimal 91 - 96</span><span class="w"></span>
<span class="w">        </span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="w">     </span><span class="c1">// Letters &#39;a&#39; through &#39;m&#39;</span><span class="w"></span>
<span class="w">        </span><span class="mi">39</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="w">     </span><span class="c1">// Letters &#39;n&#39; through &#39;z&#39;</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="w">                              </span><span class="c1">// Decimal 123 - 127</span><span class="w"></span>
<span class="w">        </span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">       </span><span class="c1">// Decimal 128 - 139</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 140 - 152</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 153 - 165</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 166 - 178</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 179 - 191</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 192 - 204</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 205 - 217</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 218 - 230</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 231 - 243</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="w">         </span><span class="c1">// Decimal 244 - 255 </span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span>
<span class="cm">/* ********  U R L   S A F E   B A S E 6 4   A L P H A B E T  ******** */</span><span class="w"></span>
<span class="w">	</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Used in the URL- and Filename-safe dialect described in Section 4 of RFC3548: </span>
<span class="cm">     * &lt;a href=&quot;http://www.faqs.org/rfcs/rfc3548.html&quot;&gt;http://www.faqs.org/rfcs/rfc3548.html&lt;/a&gt;.</span>
<span class="cm">     * Notice that the last two bytes become &quot;hyphen&quot; and &quot;underscore&quot; instead of &quot;plus&quot; and &quot;slash.&quot;</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">_URL_SAFE_ALPHABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;G&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;H&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;I&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;J&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;K&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;N&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;P&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Q&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;R&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;T&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;V&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;X&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Z&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;d&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;g&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;h&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;i&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;j&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;m&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;n&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;o&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;p&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;q&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;s&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;u&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;v&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;x&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;y&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;z&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;6&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;7&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;8&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;9&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;_&#39;</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Used in decoding URL- and Filename-safe dialects of Base64.</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">_URL_SAFE_DECODABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                 </span><span class="c1">// Decimal  0 -  8</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                      </span><span class="c1">// Whitespace: Tab and Linefeed</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                      </span><span class="c1">// Decimal 11 - 12</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Whitespace: Carriage Return</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 14 - 26</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                             </span><span class="c1">// Decimal 27 - 31</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Whitespace: Space</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">              </span><span class="c1">// Decimal 33 - 42</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Plus sign at decimal 43</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Decimal 44</span><span class="w"></span>
<span class="w">      </span><span class="mi">62</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Minus sign at decimal 45</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Decimal 46</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Slash at decimal 47</span><span class="w"></span>
<span class="w">      </span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="w">              </span><span class="c1">// Numbers zero through nine</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// Decimal 58 - 60</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Equals sign at decimal 61</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// Decimal 62 - 64</span><span class="w"></span>
<span class="w">      </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="w">            </span><span class="c1">// Letters &#39;A&#39; through &#39;N&#39;</span><span class="w"></span>
<span class="w">      </span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="w">        </span><span class="c1">// Letters &#39;O&#39; through &#39;Z&#39;</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                </span><span class="c1">// Decimal 91 - 94</span><span class="w"></span>
<span class="w">      </span><span class="mi">63</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Underscore at decimal 95</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Decimal 96</span><span class="w"></span>
<span class="w">      </span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="w">     </span><span class="c1">// Letters &#39;a&#39; through &#39;m&#39;</span><span class="w"></span>
<span class="w">      </span><span class="mi">39</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="w">     </span><span class="c1">// Letters &#39;n&#39; through &#39;z&#39;</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="w">                              </span><span class="c1">// Decimal 123 - 127</span><span class="w"></span>
<span class="w">      </span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 128 - 139</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 140 - 152</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 153 - 165</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 166 - 178</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 179 - 191</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 192 - 204</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 205 - 217</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 218 - 230</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 231 - 243</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="w">         </span><span class="c1">// Decimal 244 - 255 </span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>



<span class="cm">/* ********  O R D E R E D   B A S E 6 4   A L P H A B E T  ******** */</span><span class="w"></span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * I don&#39;t get the point of this technique, but someone requested it,</span>
<span class="cm">     * and it is described here:</span>
<span class="cm">     * &lt;a href=&quot;http://www.faqs.org/qa/rfcc-1940.html&quot;&gt;http://www.faqs.org/qa/rfcc-1940.html&lt;/a&gt;.</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">_ORDERED_ALPHABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;-&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;4&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;6&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;7&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;8&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;9&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;G&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;H&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;I&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;J&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;K&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;N&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;P&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Q&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;R&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;T&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;U&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;V&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;X&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;Z&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;_&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;d&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;g&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;h&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;i&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;j&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;m&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;n&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;o&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;p&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;q&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;s&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;u&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;v&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;x&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;y&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="sc">&#39;z&#39;</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Used in decoding the &quot;ordered&quot; dialect of Base64.</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">_ORDERED_DECODABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                 </span><span class="c1">// Decimal  0 -  8</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                      </span><span class="c1">// Whitespace: Tab and Linefeed</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                      </span><span class="c1">// Decimal 11 - 12</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Whitespace: Carriage Return</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 14 - 26</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                             </span><span class="c1">// Decimal 27 - 31</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Whitespace: Space</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">              </span><span class="c1">// Decimal 33 - 42</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Plus sign at decimal 43</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Decimal 44</span><span class="w"></span>
<span class="w">      </span><span class="mi">0</span><span class="p">,</span><span class="w">                                          </span><span class="c1">// Minus sign at decimal 45</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Decimal 46</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Slash at decimal 47</span><span class="w"></span>
<span class="w">      </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="w">                       </span><span class="c1">// Numbers zero through nine</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// Decimal 58 - 60</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Equals sign at decimal 61</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// Decimal 62 - 64</span><span class="w"></span>
<span class="w">      </span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="w">     </span><span class="c1">// Letters &#39;A&#39; through &#39;M&#39;</span><span class="w"></span>
<span class="w">      </span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="w">     </span><span class="c1">// Letters &#39;N&#39; through &#39;Z&#39;</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                </span><span class="c1">// Decimal 91 - 94</span><span class="w"></span>
<span class="w">      </span><span class="mi">37</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Underscore at decimal 95</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Decimal 96</span><span class="w"></span>
<span class="w">      </span><span class="mi">38</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="w">     </span><span class="c1">// Letters &#39;a&#39; through &#39;m&#39;</span><span class="w"></span>
<span class="w">      </span><span class="mi">51</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="w">     </span><span class="c1">// Letters &#39;n&#39; through &#39;z&#39;</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="w">                                 </span><span class="c1">// Decimal 123 - 127</span><span class="w"></span>
<span class="w">       </span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 128 - 139</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 140 - 152</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 153 - 165</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 166 - 178</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 179 - 191</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 192 - 204</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 205 - 217</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 218 - 230</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="w">     </span><span class="c1">// Decimal 231 - 243</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="w">         </span><span class="c1">// Decimal 244 - 255 </span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span>
<span class="cm">/* ********  D E T E R M I N E   W H I C H   A L H A B E T  ******** */</span><span class="w"></span>


<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Returns one of the _SOMETHING_ALPHABET byte arrays depending on</span>
<span class="cm">     * the options specified.</span>
<span class="cm">     * It&#39;s possible, though silly, to specify ORDERED &lt;b&gt;and&lt;/b&gt; URLSAFE</span>
<span class="cm">     * in which case one of them will be picked, though there is</span>
<span class="cm">     * no guarantee as to which one will be picked.</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">getAlphabet</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">URL_SAFE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">URL_SAFE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">_URL_SAFE_ALPHABET</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ORDERED</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ORDERED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">_ORDERED_ALPHABET</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">_STANDARD_ALPHABET</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">	</span><span class="c1">// end getAlphabet</span><span class="w"></span>


<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Returns one of the _SOMETHING_DECODABET byte arrays depending on</span>
<span class="cm">     * the options specified.</span>
<span class="cm">     * It&#39;s possible, though silly, to specify ORDERED and URL_SAFE</span>
<span class="cm">     * in which case one of them will be picked, though there is</span>
<span class="cm">     * no guarantee as to which one will be picked.</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">getDecodabet</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">URL_SAFE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">URL_SAFE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">_URL_SAFE_DECODABET</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ORDERED</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ORDERED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">_ORDERED_DECODABET</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">_STANDARD_DECODABET</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">	</span><span class="c1">// end getAlphabet</span><span class="w"></span>


<span class="w">    </span>
<span class="w">    </span><span class="cm">/** Defeats instantiation. */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">Base64</span><span class="p">(){}</span><span class="w"></span>
<span class="w">    </span>

<span class="w">    </span>
<span class="w">    </span>
<span class="cm">/* ********  E N C O D I N G   M E T H O D S  ******** */</span><span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Encodes up to the first three bytes of array &lt;var&gt;threeBytes&lt;/var&gt;</span>
<span class="cm">     * and returns a four-byte array in Base64 notation.</span>
<span class="cm">     * The actual number of significant bytes in your array is</span>
<span class="cm">     * given by &lt;var&gt;numSigBytes&lt;/var&gt;.</span>
<span class="cm">     * The array &lt;var&gt;threeBytes&lt;/var&gt; needs only be as big as</span>
<span class="cm">     * &lt;var&gt;numSigBytes&lt;/var&gt;.</span>
<span class="cm">     * Code can reuse a byte array by passing a four-byte array as &lt;var&gt;b4&lt;/var&gt;.</span>
<span class="cm">     *</span>
<span class="cm">     * @param b4 A reusable byte array to reduce array instantiation</span>
<span class="cm">     * @param threeBytes the array to convert</span>
<span class="cm">     * @param numSigBytes the number of significant bytes in your array</span>
<span class="cm">     * @return four byte array in Base64 notation.</span>
<span class="cm">     * @since 1.5.1</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">encode3to4</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">threeBytes</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">numSigBytes</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">encode3to4</span><span class="p">(</span><span class="w"> </span><span class="n">threeBytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">numSigBytes</span><span class="p">,</span><span class="w"> </span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">b4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end encode3to4</span><span class="w"></span>

<span class="w">    </span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * &lt;p&gt;Encodes up to three bytes of the array &lt;var&gt;source&lt;/var&gt;</span>
<span class="cm">     * and writes the resulting four Base64 bytes to &lt;var&gt;destination&lt;/var&gt;.</span>
<span class="cm">     * The source and destination arrays can be manipulated</span>
<span class="cm">     * anywhere along their length by specifying </span>
<span class="cm">     * &lt;var&gt;srcOffset&lt;/var&gt; and &lt;var&gt;destOffset&lt;/var&gt;.</span>
<span class="cm">     * This method does not check to make sure your arrays</span>
<span class="cm">     * are large enough to accomodate &lt;var&gt;srcOffset&lt;/var&gt; + 3 for</span>
<span class="cm">     * the &lt;var&gt;source&lt;/var&gt; array or &lt;var&gt;destOffset&lt;/var&gt; + 4 for</span>
<span class="cm">     * the &lt;var&gt;destination&lt;/var&gt; array.</span>
<span class="cm">     * The actual number of significant bytes in your array is</span>
<span class="cm">     * given by &lt;var&gt;numSigBytes&lt;/var&gt;.&lt;/p&gt;</span>
<span class="cm">	 * &lt;p&gt;This is the lowest level of the encoding methods with</span>
<span class="cm">	 * all possible parameters.&lt;/p&gt;</span>
<span class="cm">     *</span>
<span class="cm">     * @param source the array to convert</span>
<span class="cm">     * @param srcOffset the index where conversion begins</span>
<span class="cm">     * @param numSigBytes the number of significant bytes in your array</span>
<span class="cm">     * @param destination the array to hold the conversion</span>
<span class="cm">     * @param destOffset the index where output will be put</span>
<span class="cm">     * @return the &lt;var&gt;destination&lt;/var&gt; array</span>
<span class="cm">     * @since 1.3</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">encode3to4</span><span class="p">(</span><span class="w"> </span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">srcOffset</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">numSigBytes</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">destOffset</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>
<span class="w">	</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">ALPHABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAlphabet</span><span class="p">(</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"> </span>
<span class="w">	</span>
<span class="w">        </span><span class="c1">//           1         2         3  </span><span class="w"></span>
<span class="w">        </span><span class="c1">// 01234567890123456789012345678901 Bit position</span><span class="w"></span>
<span class="w">        </span><span class="c1">// --------000000001111111122222222 Array position from threeBytes</span><span class="w"></span>
<span class="w">        </span><span class="c1">// --------|    ||    ||    ||    | Six bit groups to index ALPHABET</span><span class="w"></span>
<span class="w">        </span><span class="c1">//          &gt;&gt;18  &gt;&gt;12  &gt;&gt; 6  &gt;&gt; 0  Right shift necessary</span><span class="w"></span>
<span class="w">        </span><span class="c1">//                0x3f  0x3f  0x3f  Additional AND</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Create buffer with zero-padding if there are only one or two</span><span class="w"></span>
<span class="w">        </span><span class="c1">// significant bytes passed in the array.</span><span class="w"></span>
<span class="w">        </span><span class="c1">// We have to shift left 24 in order to flush out the 1&#39;s that appear</span><span class="w"></span>
<span class="w">        </span><span class="c1">// when Java treats a value as negative that is cast from a byte to an int.</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">inBuff</span><span class="w"> </span><span class="o">=</span><span class="w">   </span><span class="p">(</span><span class="w"> </span><span class="n">numSigBytes</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">((</span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w">     </span><span class="o">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w">  </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">numSigBytes</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">((</span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">numSigBytes</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">((</span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="k">switch</span><span class="p">(</span><span class="w"> </span><span class="n">numSigBytes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w">     </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w">        </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x3f</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w">  </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x3f</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w">       </span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x3f</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">destination</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w">     </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w">        </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x3f</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w">  </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x3f</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EQUALS_SIGN</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">destination</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w">     </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w">        </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHABET</span><span class="o">[</span><span class="w"> </span><span class="p">(</span><span class="n">inBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x3f</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EQUALS_SIGN</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EQUALS_SIGN</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">destination</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span>
<span class="w">            </span><span class="k">default</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">destination</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end switch</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end encode3to4</span><span class="w"></span>



<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Encodes a byte array into Base64 notation.</span>
<span class="cm">     * Does not GZip-compress data.</span>
<span class="cm">     *  </span>
<span class="cm">     * @param source The data to convert</span>
<span class="cm">     * @return The data in Base64-encoded form</span>
<span class="cm">     * @throws NullPointerException if source array is null</span>
<span class="cm">     * @since 1.4</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">encodeBytes</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Since we&#39;re not going to have the GZIP encoding turned on,</span><span class="w"></span>
<span class="w">        </span><span class="c1">// we&#39;re not going to have an java.io.IOException thrown, so</span><span class="w"></span>
<span class="w">        </span><span class="c1">// we should not force the user to have to catch it.</span><span class="w"></span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">encoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encodeBytes</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">NO_OPTIONS</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end catch</span><span class="w"></span>
<span class="w">        </span><span class="k">assert</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">encoded</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end encodeBytes</span><span class="w"></span>
<span class="w">    </span>


<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Encodes a byte array into Base64 notation.</span>
<span class="cm">     * &lt;p&gt;</span>
<span class="cm">     * Example options:&lt;pre&gt;</span>
<span class="cm">     *   GZIP: gzip-compresses object before encoding it.</span>
<span class="cm">     *   DO_BREAK_LINES: break lines at 76 characters</span>
<span class="cm">     *     &lt;i&gt;Note: Technically, this makes your encoding non-compliant.&lt;/i&gt;</span>
<span class="cm">     * &lt;/pre&gt;</span>
<span class="cm">     * &lt;p&gt;</span>
<span class="cm">     * Example: &lt;code&gt;encodeBytes( myData, Base64.GZIP )&lt;/code&gt; or</span>
<span class="cm">     * &lt;p&gt;</span>
<span class="cm">     * Example: &lt;code&gt;encodeBytes( myData, Base64.GZIP | Base64.DO_BREAK_LINES )&lt;/code&gt;</span>
<span class="cm">     *</span>
<span class="cm">     *  </span>
<span class="cm">     * &lt;p&gt;As of v 2.3, if there is an error with the GZIP stream,</span>
<span class="cm">     * the method will throw an java.io.IOException. &lt;b&gt;This is new to v2.3!&lt;/b&gt;</span>
<span class="cm">     * In earlier versions, it just returned a null value, but</span>
<span class="cm">     * in retrospect that&#39;s a pretty poor way to handle it.&lt;/p&gt;</span>
<span class="cm">     * </span>
<span class="cm">     *</span>
<span class="cm">     * @param source The data to convert</span>
<span class="cm">     * @param options Specified options</span>
<span class="cm">     * @return The Base64-encoded data as a String</span>
<span class="cm">     * @see Base64#GZIP</span>
<span class="cm">     * @see Base64#DO_BREAK_LINES</span>
<span class="cm">     * @throws java.io.IOException if there is an error</span>
<span class="cm">     * @throws NullPointerException if source array is null</span>
<span class="cm">     * @since 2.0</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">encodeBytes</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">encodeBytes</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end encodeBytes</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Encodes a byte array into Base64 notation.</span>
<span class="cm">     * Does not GZip-compress data.</span>
<span class="cm">     *  </span>
<span class="cm">     * &lt;p&gt;As of v 2.3, if there is an error,</span>
<span class="cm">     * the method will throw an java.io.IOException. &lt;b&gt;This is new to v2.3!&lt;/b&gt;</span>
<span class="cm">     * In earlier versions, it just returned a null value, but</span>
<span class="cm">     * in retrospect that&#39;s a pretty poor way to handle it.&lt;/p&gt;</span>
<span class="cm">     * </span>
<span class="cm">     *</span>
<span class="cm">     * @param source The data to convert</span>
<span class="cm">     * @param off Offset in array where conversion should begin</span>
<span class="cm">     * @param len Length of data to convert</span>
<span class="cm">     * @return The Base64-encoded data as a String</span>
<span class="cm">     * @throws NullPointerException if source array is null</span>
<span class="cm">     * @throws IllegalArgumentException if source array, offset, or length are invalid</span>
<span class="cm">     * @since 1.4</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">encodeBytes</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Since we&#39;re not going to have the GZIP encoding turned on,</span><span class="w"></span>
<span class="w">        </span><span class="c1">// we&#39;re not going to have an java.io.IOException thrown, so</span><span class="w"></span>
<span class="w">        </span><span class="c1">// we should not force the user to have to catch it.</span><span class="w"></span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">encoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encodeBytes</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">NO_OPTIONS</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end catch</span><span class="w"></span>
<span class="w">        </span><span class="k">assert</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">encoded</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end encodeBytes</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Encodes a byte array into Base64 notation.</span>
<span class="cm">     * &lt;p&gt;</span>
<span class="cm">     * Example options:&lt;pre&gt;</span>
<span class="cm">     *   GZIP: gzip-compresses object before encoding it.</span>
<span class="cm">     *   DO_BREAK_LINES: break lines at 76 characters</span>
<span class="cm">     *     &lt;i&gt;Note: Technically, this makes your encoding non-compliant.&lt;/i&gt;</span>
<span class="cm">     * &lt;/pre&gt;</span>
<span class="cm">     * &lt;p&gt;</span>
<span class="cm">     * Example: &lt;code&gt;encodeBytes( myData, Base64.GZIP )&lt;/code&gt; or</span>
<span class="cm">     * &lt;p&gt;</span>
<span class="cm">     * Example: &lt;code&gt;encodeBytes( myData, Base64.GZIP | Base64.DO_BREAK_LINES )&lt;/code&gt;</span>
<span class="cm">     *</span>
<span class="cm">     *  </span>
<span class="cm">     * &lt;p&gt;As of v 2.3, if there is an error with the GZIP stream,</span>
<span class="cm">     * the method will throw an java.io.IOException. &lt;b&gt;This is new to v2.3!&lt;/b&gt;</span>
<span class="cm">     * In earlier versions, it just returned a null value, but</span>
<span class="cm">     * in retrospect that&#39;s a pretty poor way to handle it.&lt;/p&gt;</span>
<span class="cm">     * </span>
<span class="cm">     *</span>
<span class="cm">     * @param source The data to convert</span>
<span class="cm">     * @param off Offset in array where conversion should begin</span>
<span class="cm">     * @param len Length of data to convert</span>
<span class="cm">     * @param options Specified options</span>
<span class="cm">     * @return The Base64-encoded data as a String</span>
<span class="cm">     * @see Base64#GZIP</span>
<span class="cm">     * @see Base64#DO_BREAK_LINES</span>
<span class="cm">     * @throws java.io.IOException if there is an error</span>
<span class="cm">     * @throws NullPointerException if source array is null</span>
<span class="cm">     * @throws IllegalArgumentException if source array, offset, or length are invalid</span>
<span class="cm">     * @since 2.0</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="nd">@edu.umd.cs.findbugs.annotations.SuppressWarnings</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DM_DEFAULT_ENCODING&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">encodeBytes</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encodeBytesToBytes</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Return value according to relevant encoding.</span><span class="w"></span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="w"> </span><span class="n">encoded</span><span class="p">,</span><span class="w"> </span><span class="n">PREFERRED_ENCODING</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end try</span><span class="w"></span>
<span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">UnsupportedEncodingException</span><span class="w"> </span><span class="n">uue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end catch</span><span class="w"></span>
<span class="w">        </span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end encodeBytes</span><span class="w"></span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Similar to {@link #encodeBytes(byte[])} but returns</span>
<span class="cm">     * a byte array instead of instantiating a String. This is more efficient</span>
<span class="cm">     * if you&#39;re working with I/O streams and have large data sets to encode.</span>
<span class="cm">     *</span>
<span class="cm">     *</span>
<span class="cm">     * @param source The data to convert</span>
<span class="cm">     * @return The Base64-encoded data as a byte[] (of ASCII characters)</span>
<span class="cm">     * @throws NullPointerException if source array is null</span>
<span class="cm">     * @since 2.3.1</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">encodeBytesToBytes</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">encoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encodeBytesToBytes</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">NO_OPTIONS</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="n">ex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">&quot;IOExceptions only come from GZipping, which is turned off: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">encoded</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>


<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Similar to {@link #encodeBytes(byte[], int, int, int)} but returns</span>
<span class="cm">     * a byte array instead of instantiating a String. This is more efficient</span>
<span class="cm">     * if you&#39;re working with I/O streams and have large data sets to encode.</span>
<span class="cm">     *</span>
<span class="cm">     *</span>
<span class="cm">     * @param source The data to convert</span>
<span class="cm">     * @param off Offset in array where conversion should begin</span>
<span class="cm">     * @param len Length of data to convert</span>
<span class="cm">     * @param options Specified options</span>
<span class="cm">     * @return The Base64-encoded data as a String</span>
<span class="cm">     * @see Base64#GZIP</span>
<span class="cm">     * @see Base64#DO_BREAK_LINES</span>
<span class="cm">     * @throws java.io.IOException if there is an error</span>
<span class="cm">     * @throws NullPointerException if source array is null</span>
<span class="cm">     * @throws IllegalArgumentException if source array, offset, or length are invalid</span>
<span class="cm">     * @since 2.3.1</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="nd">@edu.umd.cs.findbugs.annotations.SuppressWarnings</span><span class="p">({</span><span class="s">&quot;DE_MIGHT_IGNORE&quot;</span><span class="p">})</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">encodeBytesToBytes</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NullPointerException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Cannot serialize a null array.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: null</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Cannot have negative offset: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: off &lt; 0</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Cannot have length offset: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: len &lt; 0</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="w">  </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Cannot have offset of %d and length of %d with array of length %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: off &lt; 0</span><span class="w"></span>



<span class="w">        </span><span class="c1">// Compress?</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">GZIP</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ByteArrayOutputStream</span><span class="w">  </span><span class="n">baos</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">zip</span><span class="p">.</span><span class="na">GZIPOutputStream</span><span class="w"> </span><span class="n">gzos</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">Base64</span><span class="p">.</span><span class="na">OutputStream</span><span class="w">            </span><span class="n">b64os</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>

<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">// GZip -&gt; Base64 -&gt; ByteArray</span><span class="w"></span>
<span class="w">                </span><span class="n">baos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ByteArrayOutputStream</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="n">b64os</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">OutputStream</span><span class="p">(</span><span class="w"> </span><span class="n">baos</span><span class="p">,</span><span class="w"> </span><span class="n">ENCODE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="n">gzos</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">zip</span><span class="p">.</span><span class="na">GZIPOutputStream</span><span class="p">(</span><span class="w"> </span><span class="n">b64os</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">                </span><span class="n">gzos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="n">gzos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end try</span><span class="w"></span>
<span class="w">            </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">// Catch it and then throw it immediately so that</span><span class="w"></span>
<span class="w">                </span><span class="c1">// the finally{} block is called for cleanup.</span><span class="w"></span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end catch</span><span class="w"></span>
<span class="w">            </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">try</span><span class="p">{</span><span class="w"> </span><span class="n">gzos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">){}</span><span class="w"></span>
<span class="w">                </span><span class="k">try</span><span class="p">{</span><span class="w"> </span><span class="n">b64os</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">){}</span><span class="w"></span>
<span class="w">                </span><span class="k">try</span><span class="p">{</span><span class="w"> </span><span class="n">baos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">){}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end finally</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">baos</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: compress</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Else, don&#39;t compress. Better not to use streams at all then.</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">boolean</span><span class="w"> </span><span class="n">breakLines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">DO_BREAK_LINES</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">            </span><span class="c1">//int    len43   = len * 4 / 3;</span><span class="w"></span>
<span class="w">            </span><span class="c1">//byte[] outBuff = new byte[   ( len43 )                      // Main 4:3</span><span class="w"></span>
<span class="w">            </span><span class="c1">//                           + ( (len % 3) &gt; 0 ? 4 : 0 )      // Account for padding</span><span class="w"></span>
<span class="w">            </span><span class="c1">//                           + (breakLines ? ( len43 / MAX_LINE_LENGTH ) : 0) ]; // New lines</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Try to determine more precisely how big the array needs to be.</span><span class="w"></span>
<span class="w">            </span><span class="c1">// If we get it right, we don&#39;t have to do an array copy, and</span><span class="w"></span>
<span class="w">            </span><span class="c1">// we save a bunch of memory.</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">encLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">);</span><span class="w"> </span><span class="c1">// Bytes needed for actual encoding</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">breakLines</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">                </span><span class="n">encLen</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">encLen</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">MAX_LINE_LENGTH</span><span class="p">;</span><span class="w"> </span><span class="c1">// Plus extra newline characters</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="w"> </span><span class="n">encLen</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>


<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">len2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">lineLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len2</span><span class="p">;</span><span class="w"> </span><span class="n">d</span><span class="o">+=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">+=</span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">encode3to4</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="o">+</span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">outBuff</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">                </span><span class="n">lineLength</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">breakLines</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lineLength</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">MAX_LINE_LENGTH</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">outBuff</span><span class="o">[</span><span class="n">e</span><span class="o">+</span><span class="mi">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NEW_LINE</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="n">e</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="n">lineLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: end of line</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// en dfor: each piece of array</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">encode3to4</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="o">+</span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">outBuff</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="n">e</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: some padding needed</span><span class="w"></span>


<span class="w">            </span><span class="c1">// Only resize array if we didn&#39;t guess it right.</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">outBuff</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">                </span><span class="c1">// If breaking lines and the last byte falls right at</span><span class="w"></span>
<span class="w">                </span><span class="c1">// the line length (76 bytes per line), there will be</span><span class="w"></span>
<span class="w">                </span><span class="c1">// one extra byte, and the array will need to be resized.</span><span class="w"></span>
<span class="w">                </span><span class="c1">// Not too bad of an estimate on array size, I&#39;d say.</span><span class="w"></span>
<span class="w">                </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">finalOut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">e</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">outBuff</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">finalOut</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">e</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="c1">//System.err.println(&quot;Having to resize array from &quot; + outBuff.length + &quot; to &quot; + e );</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">finalOut</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">//System.err.println(&quot;No need to resize array.&quot;);</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">outBuff</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else: don&#39;t compress</span><span class="w"></span>

<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end encodeBytesToBytes</span><span class="w"></span>
<span class="w">    </span>

<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="cm">/* ********  D E C O D I N G   M E T H O D S  ******** */</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Decodes four bytes from array &lt;var&gt;source&lt;/var&gt;</span>
<span class="cm">     * and writes the resulting bytes (up to three of them)</span>
<span class="cm">     * to &lt;var&gt;destination&lt;/var&gt;.</span>
<span class="cm">     * The source and destination arrays can be manipulated</span>
<span class="cm">     * anywhere along their length by specifying </span>
<span class="cm">     * &lt;var&gt;srcOffset&lt;/var&gt; and &lt;var&gt;destOffset&lt;/var&gt;.</span>
<span class="cm">     * This method does not check to make sure your arrays</span>
<span class="cm">     * are large enough to accomodate &lt;var&gt;srcOffset&lt;/var&gt; + 4 for</span>
<span class="cm">     * the &lt;var&gt;source&lt;/var&gt; array or &lt;var&gt;destOffset&lt;/var&gt; + 3 for</span>
<span class="cm">     * the &lt;var&gt;destination&lt;/var&gt; array.</span>
<span class="cm">     * This method returns the actual number of bytes that </span>
<span class="cm">     * were converted from the Base64 encoding.</span>
<span class="cm">	 * &lt;p&gt;This is the lowest level of the decoding methods with</span>
<span class="cm">	 * all possible parameters.&lt;/p&gt;</span>
<span class="cm">     * </span>
<span class="cm">     *</span>
<span class="cm">     * @param source the array to convert</span>
<span class="cm">     * @param srcOffset the index where conversion begins</span>
<span class="cm">     * @param destination the array to hold the conversion</span>
<span class="cm">     * @param destOffset the index where output will be put</span>
<span class="cm">	 * @param options alphabet type is pulled from this (standard, url-safe, ordered)</span>
<span class="cm">     * @return the number of decoded bytes converted</span>
<span class="cm">     * @throws NullPointerException if source or destination arrays are null</span>
<span class="cm">     * @throws IllegalArgumentException if srcOffset or destOffset are invalid</span>
<span class="cm">     *         or there is not enough room in the array.</span>
<span class="cm">     * @since 1.3</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">decode4to3</span><span class="p">(</span><span class="w"> </span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">srcOffset</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">destOffset</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Lots of error checking and exception throwing</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NullPointerException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Source array was null.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NullPointerException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Destination array was null.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="s">&quot;Source array with length %d cannot have offset of %d and still process four bytes.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">destination</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="s">&quot;Destination array with length %d cannot have offset of %d and still store three bytes.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">DECODABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getDecodabet</span><span class="p">(</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"> </span>
<span class="w">	</span>
<span class="w">        </span><span class="c1">// Example: Dk==</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EQUALS_SIGN</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Two ways to do the same thing. Don&#39;t know which way I like best.</span><span class="w"></span>
<span class="w">          </span><span class="c1">//int outBuff =   ( ( DECODABET[ source[ srcOffset    ] ] &lt;&lt; 24 ) &gt;&gt;&gt;  6 )</span><span class="w"></span>
<span class="w">          </span><span class="c1">//              | ( ( DECODABET[ source[ srcOffset + 1] ] &lt;&lt; 24 ) &gt;&gt;&gt; 12 );</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">=</span><span class="w">   </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w">    </span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">                          </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Example: DkL=</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EQUALS_SIGN</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Two ways to do the same thing. Don&#39;t know which way I like best.</span><span class="w"></span>
<span class="w">          </span><span class="c1">//int outBuff =   ( ( DECODABET[ source[ srcOffset     ] ] &lt;&lt; 24 ) &gt;&gt;&gt;  6 )</span><span class="w"></span>
<span class="w">          </span><span class="c1">//              | ( ( DECODABET[ source[ srcOffset + 1 ] ] &lt;&lt; 24 ) &gt;&gt;&gt; 12 )</span><span class="w"></span>
<span class="w">          </span><span class="c1">//              | ( ( DECODABET[ source[ srcOffset + 2 ] ] &lt;&lt; 24 ) &gt;&gt;&gt; 18 );</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">=</span><span class="w">   </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w">     </span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">                          </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">                          </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w">     </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Example: DkLE</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Two ways to do the same thing. Don&#39;t know which way I like best.</span><span class="w"></span>
<span class="w">          </span><span class="c1">//int outBuff =   ( ( DECODABET[ source[ srcOffset     ] ] &lt;&lt; 24 ) &gt;&gt;&gt;  6 )</span><span class="w"></span>
<span class="w">          </span><span class="c1">//              | ( ( DECODABET[ source[ srcOffset + 1 ] ] &lt;&lt; 24 ) &gt;&gt;&gt; 12 )</span><span class="w"></span>
<span class="w">          </span><span class="c1">//              | ( ( DECODABET[ source[ srcOffset + 2 ] ] &lt;&lt; 24 ) &gt;&gt;&gt; 18 )</span><span class="w"></span>
<span class="w">          </span><span class="c1">//              | ( ( DECODABET[ source[ srcOffset + 3 ] ] &lt;&lt; 24 ) &gt;&gt;&gt; 24 );</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">=</span><span class="w">   </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w">     </span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">                          </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">                          </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<span class="w">                          </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="w"> </span><span class="n">srcOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="w"> </span><span class="p">)</span><span class="w">      </span><span class="p">);</span><span class="w"></span>

<span class="w">            </span>
<span class="w">            </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w">     </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">destination</span><span class="o">[</span><span class="w"> </span><span class="n">destOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="w"> </span><span class="n">outBuff</span><span class="w">       </span><span class="p">);</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end decodeToBytes</span><span class="w"></span>
<span class="w">    </span>




<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Low-level access to decoding ASCII characters in</span>
<span class="cm">     * the form of a byte array. &lt;strong&gt;Ignores GUNZIP option, if</span>
<span class="cm">     * it&#39;s set.&lt;/strong&gt; This is not generally a recommended method,</span>
<span class="cm">     * although it is used internally as part of the decoding process.</span>
<span class="cm">     * Special case: if len = 0, an empty array is returned. Still,</span>
<span class="cm">     * if you need more speed and reduced memory footprint (and aren&#39;t</span>
<span class="cm">     * gzipping), consider this method.</span>
<span class="cm">     *</span>
<span class="cm">     * @param source The Base64 encoded data</span>
<span class="cm">     * @return decoded data</span>
<span class="cm">     * @since 2.3.1</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">decoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="c1">//        try {</span><span class="w"></span>
<span class="w">            </span><span class="n">decoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">NO_OPTIONS</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="c1">//        } catch( java.io.IOException ex ) {</span><span class="w"></span>
<span class="c1">//            assert false : &quot;IOExceptions only come from GZipping, which is turned off: &quot; + ex.getMessage();</span><span class="w"></span>
<span class="c1">//        }</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">decoded</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Low-level access to decoding ASCII characters in</span>
<span class="cm">     * the form of a byte array. &lt;strong&gt;Ignores GUNZIP option, if</span>
<span class="cm">     * it&#39;s set.&lt;/strong&gt; This is not generally a recommended method,</span>
<span class="cm">     * although it is used internally as part of the decoding process.</span>
<span class="cm">     * Special case: if len = 0, an empty array is returned. Still,</span>
<span class="cm">     * if you need more speed and reduced memory footprint (and aren&#39;t</span>
<span class="cm">     * gzipping), consider this method.</span>
<span class="cm">     *</span>
<span class="cm">     * @param source The Base64 encoded data</span>
<span class="cm">     * @param off    The offset of where to begin decoding</span>
<span class="cm">     * @param len    The length of characters to decode</span>
<span class="cm">     * @param options Can specify options such as alphabet type to use</span>
<span class="cm">     * @return decoded data</span>
<span class="cm">     * @throws java.io.IOException If bogus characters exist in source data</span>
<span class="cm">     * @since 1.3</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Lots of error checking and exception throwing</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NullPointerException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Cannot decode null source array.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="s">&quot;Source array with length %d cannot have offset of %d and process %d bytes.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="w"> </span>
<span class="w">            </span><span class="s">&quot;Base64-encoded string must have at least four characters, but length specified was &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">DECODABET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getDecodabet</span><span class="p">(</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">	</span>
<span class="w">        </span><span class="kt">int</span><span class="w">    </span><span class="n">len34</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">       </span><span class="c1">// Estimate on array size</span><span class="w"></span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">outBuff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="w"> </span><span class="n">len34</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="c1">// Upper limit on size of output</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">    </span><span class="n">outBuffPosn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">             </span><span class="c1">// Keep track of where we&#39;re writing</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">b4</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span><span class="w">     </span><span class="c1">// Four byte buffer from source, eliminating white space</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">    </span><span class="n">b4Posn</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">               </span><span class="c1">// Keep track of four byte input buffer</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w">    </span><span class="n">i</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">               </span><span class="c1">// Source array counter</span><span class="w"></span>
<span class="w">        </span><span class="kt">byte</span><span class="w">   </span><span class="n">sbiDecode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">               </span><span class="c1">// Special value from DECODABET</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">off</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">off</span><span class="o">+</span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Loop through source</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="n">sbiDecode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DECODABET</span><span class="o">[</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="n">i</span><span class="o">]&amp;</span><span class="mh">0xFF</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="c1">// White space, Equals sign, or legit Base64 character</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Note the values such as -5 and -9 in the</span><span class="w"></span>
<span class="w">            </span><span class="c1">// DECODABETs at the top of the file.</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">sbiDecode</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">WHITE_SPACE_ENC</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">sbiDecode</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">EQUALS_SIGN_ENC</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">b4</span><span class="o">[</span><span class="w"> </span><span class="n">b4Posn</span><span class="o">++</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w">         </span><span class="c1">// Save non-whitespace</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">b4Posn</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                  </span><span class="c1">// Time to decode?</span><span class="w"></span>
<span class="w">                        </span><span class="n">outBuffPosn</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">decode4to3</span><span class="p">(</span><span class="w"> </span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">outBuff</span><span class="p">,</span><span class="w"> </span><span class="n">outBuffPosn</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                        </span><span class="n">b4Posn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span>
<span class="w">                        </span><span class="c1">// If that was the equals sign, break out of &#39;for&#39; loop</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EQUALS_SIGN</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: equals sign</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: quartet built</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: equals sign or better</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: white space, equals sign or better</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">// There&#39;s a bad input character in the Base64 stream.</span><span class="w"></span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="p">(</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="w"></span>
<span class="w">                </span><span class="s">&quot;Bad Base64 input character decimal %d in array position %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">source</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else: </span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// each input character</span><span class="w"></span>
<span class="w">                                   </span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="w"> </span><span class="n">outBuffPosn</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="w"> </span><span class="n">outBuff</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">outBuffPosn</span><span class="w"> </span><span class="p">);</span><span class="w"> </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end decode</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">	</span>
<span class="w">	</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Decodes data from Base64 notation, automatically</span>
<span class="cm">     * detecting gzip-compressed data and decompressing it.</span>
<span class="cm">     *</span>
<span class="cm">     * @param s the string to decode</span>
<span class="cm">     * @return the decoded data</span>
<span class="cm">     * @throws java.io.IOException If there is a problem</span>
<span class="cm">     * @since 1.4</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">NO_OPTIONS</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Decodes data from Base64 notation, automatically</span>
<span class="cm">     * detecting gzip-compressed data and decompressing it.</span>
<span class="cm">     *</span>
<span class="cm">     * @param s the string to decode</span>
<span class="cm">     * @param options encode options such as URL_SAFE</span>
<span class="cm">     * @return the decoded data</span>
<span class="cm">     * @throws java.io.IOException if there is an error</span>
<span class="cm">     * @throws NullPointerException if &lt;tt&gt;s&lt;/tt&gt; is null</span>
<span class="cm">     * @since 1.4</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="nd">@edu.umd.cs.findbugs.annotations.SuppressWarnings</span><span class="p">({</span><span class="s">&quot;DM_DEFAULT_ENCODING&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DE_MIGHT_IGNORE&quot;</span><span class="p">})</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NullPointerException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Input string was null.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bytes</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="w"> </span><span class="n">PREFERRED_ENCODING</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end try</span><span class="w"></span>
<span class="w">        </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">UnsupportedEncodingException</span><span class="w"> </span><span class="n">uee</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="na">getBytes</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end catch</span><span class="w"></span>
<span class="w">		</span><span class="c1">//&lt;/change&gt;</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Decode</span><span class="w"></span>
<span class="w">        </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Check to see if it&#39;s gzip-compressed</span><span class="w"></span>
<span class="w">        </span><span class="c1">// GZIP Magic Two-Byte Number: 0x8b1f (35615)</span><span class="w"></span>
<span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">dontGunzip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">DONT_GUNZIP</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">bytes</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">dontGunzip</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">bytes</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">((</span><span class="n">bytes</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff00</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">zip</span><span class="p">.</span><span class="na">GZIPInputStream</span><span class="p">.</span><span class="na">GZIP_MAGIC</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ByteArrayInputStream</span><span class="w">  </span><span class="n">bais</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">zip</span><span class="p">.</span><span class="na">GZIPInputStream</span><span class="w"> </span><span class="n">gzis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ByteArrayOutputStream</span><span class="w"> </span><span class="n">baos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">2048</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="kt">int</span><span class="w">    </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">baos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ByteArrayOutputStream</span><span class="p">();</span><span class="w"></span>
<span class="w">                    </span><span class="n">bais</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ByteArrayInputStream</span><span class="p">(</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="n">gzis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">zip</span><span class="p">.</span><span class="na">GZIPInputStream</span><span class="p">(</span><span class="w"> </span><span class="n">bais</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">                    </span><span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gzis</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">baos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end while: reading input</span><span class="w"></span>

<span class="w">                    </span><span class="c1">// No error? Get new bytes.</span><span class="w"></span>
<span class="w">                    </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baos</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">();</span><span class="w"></span>

<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end try</span><span class="w"></span>
<span class="w">                </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w"></span>
<span class="w">                    </span><span class="c1">// Just return originally-decoded bytes</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end catch</span><span class="w"></span>
<span class="w">                </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">try</span><span class="p">{</span><span class="w"> </span><span class="n">baos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">){}</span><span class="w"></span>
<span class="w">                    </span><span class="k">try</span><span class="p">{</span><span class="w"> </span><span class="n">gzis</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">){}</span><span class="w"></span>
<span class="w">                    </span><span class="k">try</span><span class="p">{</span><span class="w"> </span><span class="n">bais</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">){}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end finally</span><span class="w"></span>

<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: gzipped</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: bytes.length &gt;= 2</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bytes</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end decode</span><span class="w"></span>



<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * A {@link Base64.InputStream} will read data from another</span>
<span class="cm">     * &lt;tt&gt;java.io.InputStream&lt;/tt&gt;, given in the constructor,</span>
<span class="cm">     * and encode/decode to/from Base64 notation on the fly.</span>
<span class="cm">     *</span>
<span class="cm">     * @see Base64</span>
<span class="cm">     * @since 1.3</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">InputStream</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">FilterInputStream</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">encode</span><span class="p">;</span><span class="w">         </span><span class="c1">// Encoding or decoding</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">position</span><span class="p">;</span><span class="w">       </span><span class="c1">// Current position in the buffer</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w">  </span><span class="n">buffer</span><span class="p">;</span><span class="w">         </span><span class="c1">// Small buffer holding converted data</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">bufferLength</span><span class="p">;</span><span class="w">   </span><span class="c1">// Length of buffer (3 or 4)</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">numSigBytes</span><span class="p">;</span><span class="w">    </span><span class="c1">// Number of meaningful bytes in the buffer</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">lineLength</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">breakLines</span><span class="p">;</span><span class="w">     </span><span class="c1">// Break lines at less than 80 characters</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">options</span><span class="p">;</span><span class="w">        </span><span class="c1">// Record options used to create the stream.</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w">  </span><span class="n">decodabet</span><span class="p">;</span><span class="w">      </span><span class="c1">// Local copies to avoid extra method calls</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Constructs a {@link Base64.InputStream} in DECODE mode.</span>
<span class="cm">         *</span>
<span class="cm">         * @param in the &lt;tt&gt;java.io.InputStream&lt;/tt&gt; from which to read data.</span>
<span class="cm">         * @since 1.3</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">InputStream</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">InputStream</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">DECODE</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end constructor</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Constructs a {@link Base64.InputStream} in</span>
<span class="cm">         * either ENCODE or DECODE mode.</span>
<span class="cm">         * &lt;p&gt;</span>
<span class="cm">         * Valid options:&lt;pre&gt;</span>
<span class="cm">         *   ENCODE or DECODE: Encode or Decode as data is read.</span>
<span class="cm">         *   DO_BREAK_LINES: break lines at 76 characters</span>
<span class="cm">         *     (only meaningful when encoding)&lt;/i&gt;</span>
<span class="cm">         * &lt;/pre&gt;</span>
<span class="cm">         * &lt;p&gt;</span>
<span class="cm">         * Example: &lt;code&gt;new Base64.InputStream( in, Base64.DECODE )&lt;/code&gt;</span>
<span class="cm">         *</span>
<span class="cm">         *</span>
<span class="cm">         * @param in the &lt;tt&gt;java.io.InputStream&lt;/tt&gt; from which to read data.</span>
<span class="cm">         * @param options Specified options</span>
<span class="cm">         * @see Base64#ENCODE</span>
<span class="cm">         * @see Base64#DECODE</span>
<span class="cm">         * @see Base64#DO_BREAK_LINES</span>
<span class="cm">         * @since 2.0</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">InputStream</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">InputStream</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="kd">super</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">options</span><span class="p">;</span><span class="w"> </span><span class="c1">// Record for later</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">breakLines</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">DO_BREAK_LINES</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">encode</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ENCODE</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">bufferLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">buffer</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="w"> </span><span class="n">bufferLength</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">position</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">lineLength</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">decodabet</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">getDecodabet</span><span class="p">(</span><span class="n">options</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end constructor</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Reads enough of the input stream to convert</span>
<span class="cm">         * to/from Base64 and returns the next byte.</span>
<span class="cm">         *</span>
<span class="cm">         * @return next byte</span>
<span class="cm">         * @since 1.3</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">read</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="c1">// Do we need to get data?</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">numBinaryBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="p">.</span><span class="na">read</span><span class="p">();</span><span class="w"></span>

<span class="w">                        </span><span class="c1">// If end of stream, b is -1.</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="n">b3</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">                            </span><span class="n">numBinaryBytes</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// out of for loop</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else: end of stream</span><span class="w"></span>
<span class="w">                            </span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end for: each needed input byte</span><span class="w"></span>
<span class="w">                    </span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">numBinaryBytes</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">encode3to4</span><span class="p">(</span><span class="w"> </span><span class="n">b3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">numBinaryBytes</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                        </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="n">numSigBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: got data</span><span class="w"></span>
<span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// Must be end of stream</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: encoding</span><span class="w"></span>
<span class="w">                </span>
<span class="w">                </span><span class="c1">// Else decoding</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">b4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="c1">// Read four &quot;meaningful&quot; bytes:</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="k">do</span><span class="p">{</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="p">.</span><span class="na">read</span><span class="p">();</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">decodabet</span><span class="o">[</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x7f</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">WHITE_SPACE_ENC</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                        </span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// Reads a -1 if end of stream</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: end of stream</span><span class="w"></span>
<span class="w">                        </span>
<span class="w">                        </span><span class="n">b4</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end for: each needed input byte</span><span class="w"></span>
<span class="w">                    </span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">numSigBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decode4to3</span><span class="p">(</span><span class="w"> </span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                        </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: got four characters</span><span class="w"></span>
<span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else if: also padded correctly</span><span class="w"></span>
<span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="c1">// Must have broken out from above.</span><span class="w"></span>
<span class="w">                        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Improperly padded Base64 input.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end </span><span class="w"></span>
<span class="w">                    </span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else: decode</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else: get data</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="c1">// Got data?</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">// End of relevant data?</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="cm">/*!encode &amp;&amp;*/</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">numSigBytes</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: got data</span><span class="w"></span>
<span class="w">                </span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">breakLines</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lineLength</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">MAX_LINE_LENGTH</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">lineLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">lineLength</span><span class="o">++</span><span class="p">;</span><span class="w">   </span><span class="c1">// This isn&#39;t important when decoding</span><span class="w"></span>
<span class="w">                                    </span><span class="c1">// but throwing an extra &quot;if&quot; seems</span><span class="w"></span>
<span class="w">                                    </span><span class="c1">// just as wasteful.</span><span class="w"></span>
<span class="w">                    </span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="o">[</span><span class="w"> </span><span class="n">position</span><span class="o">++</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">bufferLength</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: end</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">;</span><span class="w"> </span><span class="c1">// This is how you &quot;cast&quot; a byte that&#39;s</span><span class="w"></span>
<span class="w">                                     </span><span class="c1">// intended to be unsigned.</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: position &gt;= 0</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="c1">// Else error</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Error in Base64 code reading stream.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end read</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Calls {@link #read()} repeatedly until the end of stream</span>
<span class="cm">         * is reached or &lt;var&gt;len&lt;/var&gt; bytes are read.</span>
<span class="cm">         * Returns number of bytes read into array or -1 if</span>
<span class="cm">         * end of stream is encountered.</span>
<span class="cm">         *</span>
<span class="cm">         * @param dest array to hold values</span>
<span class="cm">         * @param off offset for array</span>
<span class="cm">         * @param len max number of bytes to read into array</span>
<span class="cm">         * @return bytes read into array or -1 if end of stream is encountered.</span>
<span class="cm">         * @since 1.3</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">dest</span><span class="o">[</span><span class="n">off</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// Out of &#39;for&#39; loop</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="c1">// Out of &#39;for&#39; loop</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end for: each byte read</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end read</span><span class="w"></span>
<span class="w">        </span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end inner class InputStream</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/* ********  I N N E R   C L A S S   O U T P U T S T R E A M  ******** */</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * A {@link Base64.OutputStream} will write data to another</span>
<span class="cm">     * &lt;tt&gt;java.io.OutputStream&lt;/tt&gt;, given in the constructor,</span>
<span class="cm">     * and encode/decode to/from Base64 notation on the fly.</span>
<span class="cm">     *</span>
<span class="cm">     * @see Base64</span>
<span class="cm">     * @since 1.3</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OutputStream</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">FilterOutputStream</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">encode</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">position</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w">  </span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">bufferLength</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">lineLength</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">breakLines</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w">  </span><span class="n">b4</span><span class="p">;</span><span class="w">         </span><span class="c1">// Scratch used in a few places</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">suspendEncoding</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w">     </span><span class="n">options</span><span class="p">;</span><span class="w">    </span><span class="c1">// Record for later</span><span class="w"></span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w">  </span><span class="n">decodabet</span><span class="p">;</span><span class="w">  </span><span class="c1">// Local copies to avoid extra method calls</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Constructs a {@link Base64.OutputStream} in ENCODE mode.</span>
<span class="cm">         *</span>
<span class="cm">         * @param out the &lt;tt&gt;java.io.OutputStream&lt;/tt&gt; to which data will be written.</span>
<span class="cm">         * @since 1.3</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">OutputStream</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">OutputStream</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">(</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">ENCODE</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end constructor</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Constructs a {@link Base64.OutputStream} in</span>
<span class="cm">         * either ENCODE or DECODE mode.</span>
<span class="cm">         * &lt;p&gt;</span>
<span class="cm">         * Valid options:&lt;pre&gt;</span>
<span class="cm">         *   ENCODE or DECODE: Encode or Decode as data is read.</span>
<span class="cm">         *   DO_BREAK_LINES: don&#39;t break lines at 76 characters</span>
<span class="cm">         *     (only meaningful when encoding)&lt;/i&gt;</span>
<span class="cm">         * &lt;/pre&gt;</span>
<span class="cm">         * &lt;p&gt;</span>
<span class="cm">         * Example: &lt;code&gt;new Base64.OutputStream( out, Base64.ENCODE )&lt;/code&gt;</span>
<span class="cm">         *</span>
<span class="cm">         * @param out the &lt;tt&gt;java.io.OutputStream&lt;/tt&gt; to which data will be written.</span>
<span class="cm">         * @param options Specified options.</span>
<span class="cm">         * @see Base64#ENCODE</span>
<span class="cm">         * @see Base64#DECODE</span>
<span class="cm">         * @see Base64#DO_BREAK_LINES</span>
<span class="cm">         * @since 1.3</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">OutputStream</span><span class="p">(</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">OutputStream</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kd">super</span><span class="p">(</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">breakLines</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">DO_BREAK_LINES</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">encode</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ENCODE</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">bufferLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">buffer</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="w"> </span><span class="n">bufferLength</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">position</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">lineLength</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">suspendEncoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">b4</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">options</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">decodabet</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">getDecodabet</span><span class="p">(</span><span class="n">options</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end constructor</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Writes the byte to the output stream after</span>
<span class="cm">         * converting to/from Base64 notation.</span>
<span class="cm">         * When encoding, bytes are buffered three</span>
<span class="cm">         * at a time before the output stream actually</span>
<span class="cm">         * gets a write() call.</span>
<span class="cm">         * When decoding, bytes are buffered four</span>
<span class="cm">         * at a time.</span>
<span class="cm">         *</span>
<span class="cm">         * @param theByte the byte to write</span>
<span class="cm">         * @since 1.3</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">theByte</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Encoding suspended?</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">suspendEncoding</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="w"> </span><span class="n">theByte</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: supsended</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="c1">// Encode?</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">buffer</span><span class="o">[</span><span class="w"> </span><span class="n">position</span><span class="o">++</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="n">theByte</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">bufferLength</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Enough to encode.</span><span class="w"></span>
<span class="w">                </span>
<span class="w">                    </span><span class="k">this</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="w"> </span><span class="n">encode3to4</span><span class="p">(</span><span class="w"> </span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">bufferLength</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">                    </span><span class="n">lineLength</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">breakLines</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lineLength</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">MAX_LINE_LENGTH</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">this</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="w"> </span><span class="n">NEW_LINE</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                        </span><span class="n">lineLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: end of line</span><span class="w"></span>

<span class="w">                    </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: enough to output</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: encoding</span><span class="w"></span>

<span class="w">            </span><span class="c1">// Else, Decoding</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">// Meaningful Base64 character?</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">decodabet</span><span class="o">[</span><span class="w"> </span><span class="n">theByte</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x7f</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">WHITE_SPACE_ENC</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">buffer</span><span class="o">[</span><span class="w"> </span><span class="n">position</span><span class="o">++</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="n">theByte</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">bufferLength</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Enough to output.</span><span class="w"></span>
<span class="w">                    </span>
<span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">decode4to3</span><span class="p">(</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                        </span><span class="n">out</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="w"> </span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                        </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: enough to output</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: meaningful base64 character</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">decodabet</span><span class="o">[</span><span class="w"> </span><span class="n">theByte</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x7f</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">WHITE_SPACE_ENC</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Invalid character in Base64 data.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else: not white space either</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else: decoding</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end write</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Calls {@link #write(int)} repeatedly until &lt;var&gt;len&lt;/var&gt; </span>
<span class="cm">         * bytes are written.</span>
<span class="cm">         *</span>
<span class="cm">         * @param theBytes array from which to read bytes</span>
<span class="cm">         * @param off offset for array</span>
<span class="cm">         * @param len max number of bytes to read into array</span>
<span class="cm">         * @since 1.3</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">theBytes</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Encoding suspended?</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">suspendEncoding</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="w"> </span><span class="n">theBytes</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: supsended</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">write</span><span class="p">(</span><span class="w"> </span><span class="n">theBytes</span><span class="o">[</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end for: each byte written</span><span class="w"></span>
<span class="w">            </span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end write</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Method added by PHIL. [Thanks, PHIL. -Rob]</span>
<span class="cm">         * This pads the buffer without closing the stream.</span>
<span class="cm">         * @throws java.io.IOException  if there&#39;s an error.</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">flushBase64</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">out</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="w"> </span><span class="n">encode3to4</span><span class="p">(</span><span class="w"> </span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: encoding</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Base64 input not properly padded.&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w">   </span><span class="c1">// end else: decoding</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w">   </span><span class="c1">// end if: buffer partially full</span><span class="w"></span>

<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end flush</span><span class="w"></span>

<span class="w">        </span>
<span class="w">        </span><span class="cm">/** </span>
<span class="cm">         * Flushes and closes (I think, in the superclass) the stream. </span>
<span class="cm">         *</span>
<span class="cm">         * @since 1.3</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">close</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// 1. Ensure that pending characters are written</span><span class="w"></span>
<span class="w">            </span><span class="n">flushBase64</span><span class="p">();</span><span class="w"></span>

<span class="w">            </span><span class="c1">// 2. Actually close the stream</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Base class both flushes and closes.</span><span class="w"></span>
<span class="w">            </span><span class="kd">super</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w"></span>
<span class="w">            </span>
<span class="w">            </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">out</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end close</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Suspends encoding of the stream.</span>
<span class="cm">         * May be helpful if you need to embed a piece of</span>
<span class="cm">         * base64-encoded data in a stream.</span>
<span class="cm">         *</span>
<span class="cm">         * @throws java.io.IOException  if there&#39;s an error flushing</span>
<span class="cm">         * @since 1.5.1</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">suspendEncoding</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">IOException</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">flushBase64</span><span class="p">();</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">suspendEncoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end suspendEncoding</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * Resumes encoding of the stream.</span>
<span class="cm">         * May be helpful if you need to embed a piece of</span>
<span class="cm">         * base64-encoded data in a stream.</span>
<span class="cm">         *</span>
<span class="cm">         * @since 1.5.1</span>
<span class="cm">         */</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">resumeEncoding</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">suspendEncoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span><span class="c1">// end resumeEncoding</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">        </span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span><span class="c1">// end inner class OutputStream</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span>
<span class="p">}</span><span class="w">   </span><span class="c1">// end class Base64</span><span class="w"></span>
</pre></div>
</body>
</html>
